### Auth API Test Requests
### RESTful API endpoints following RESTful standards
### 
### Prerequisites:
### 1. Make sure the server is running (default: http://localhost:3000)
### 2. Session cookies are automatically handled by REST Client
### 3. Update variables below with your test data

@baseUrl = http://localhost:3000
@contentType = application/json


### Variables (update these with your actual test values)

@sessionCookie = your-session-cookie-here
@testAdminRole = admin
@testEmail = newuser@example.com
@testPartnerRole = partner
@testPassword = password123
@testPhoneNumber = +1234567890
@testUserRole = customer


### 
### SESSION RESOURCE
### 

### GET /api/auth/session
### Check authentication status

GET {{baseUrl}}/api/auth/session HTTP/1.1
Content-Type: {{contentType}}

### 


### GET /api/auth/session (Authenticated)


### Check authentication status when logged in

GET {{baseUrl}}/api/auth/session HTTP/1.1
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}


### 


### 


### LOGIN/LOGOUT (SESSIONS)


### 


### POST /api/auth/sessions


### Login (create session) - Customer

POST {{baseUrl}}/api/auth/sessions HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "password": "{{testPassword}}",
  "userRole": "customer"
}


### 


### POST /api/auth/sessions


### Login (create session) - Partner

POST {{baseUrl}}/api/v1/auth/sessions HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "partner@example.com",
  "password": "password123",
  "userRole": "partner"
}


### 


### POST /api/auth/sessions (Invalid - missing fields)


### Should return 400 Bad Request with validation errors

POST {{baseUrl}}/api/auth/sessions HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}"
}


### 


### POST /api/auth/sessions (Invalid - wrong credentials)


### Should return 401 Unauthorized

POST {{baseUrl}}/api/auth/sessions HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "wrong@example.com",
  "password": "wrongpassword",
  "userRole": "customer"
}


### 


### POST /api/auth/sessions (Invalid - invalid email format)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/sessions HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "invalid-email",
  "password": "{{testPassword}}",
  "userRole": "customer"
}


### 


### DELETE /api/auth/sessions


### Logout (destroy session)


### Note: Returns 204 No Content (no response body)

DELETE {{baseUrl}}/api/auth/sessions HTTP/1.1
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}


### 


### 


### EMAIL RESOURCE


### 


### POST /api/auth/email/check


### Check if email exists - Customer

POST {{baseUrl}}/api/auth/email/check HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "userRole": "customer"
}


### 


### POST /api/auth/email/check


### Check if email exists - Partner

POST {{baseUrl}}/api/auth/email/check HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "partner@example.com",
  "userRole": "partner"
}


### 


### POST /api/auth/email/check (Invalid - missing fields)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/email/check HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}"
}


### 


### POST /api/auth/email/check (Invalid - invalid email format)


### Should return 400 Bad Request

POST {{baseUrl}}/api/v1/auth/email/check HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "invalid-email",
  "userRole": "customer"
}


### 


### 


### USER REGISTRATION


### 


### POST /api/auth/users


### Register new customer

POST {{baseUrl}}/api/v1/auth/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "newuser@example.com",
  "password": "123",
  "userRole": "customer"
}


### 


### POST /api/auth/users


### Register new customer (another example)

POST {{baseUrl}}/api/auth/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "customer2@example.com",
  "password": "securePassword123",
  "userRole": "customer"
}


### 


### POST /api/auth/users (Invalid - user already exists)


### Should return 409 Conflict

POST {{baseUrl}}/api/auth/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "password": "{{testPassword}}",
  "userRole": "customer"
}


### 


### POST /api/auth/users (Invalid - weak password)


### Should return 400 Bad Request (password too short)

POST {{baseUrl}}/api/auth/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "newuser2@example.com",
  "password": "short",
  "userRole": "customer"
}


### 


### POST /api/auth/users (Invalid - invalid user role)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "newuser3@example.com",
  "password": "password123",
  "userRole": "invalid_role"
}


### 


### 


### PASSWORD RESET


### 


### POST /api/auth/password/forgot


### Request password reset OTP - Customer

POST {{baseUrl}}/api/auth/password/forgot HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "userRole": "customer"
}


### 


### POST /api/auth/password/forgot


### Request password reset OTP - Partner

POST {{baseUrl}}/api/auth/password/forgot HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "partner@example.com",
  "userRole": "partner"
}


### 


### POST /api/auth/password/forgot (Invalid - user not found)


### Should return 404 Not Found

POST {{baseUrl}}/api/auth/password/forgot HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "nonexistent@example.com",
  "userRole": "customer"
}


### 


### POST /api/auth/password/forgot (Rate limit test)


### Request OTP multiple times to test rate limiting


### Should return 429 Too Many Requests after 3 attempts

POST {{baseUrl}}/api/auth/password/forgot HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "userRole": "customer"
}


### 


### POST /api/auth/password/reset


### Reset password with OTP


### Note: Replace {{otp}} with the OTP received via email

POST {{baseUrl}}/api/auth/password/reset HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "newPassword": "newPassword123",
  "otp": "1234",
  "userRole": "customer"
}


### 


### POST /api/auth/password/reset (Invalid - wrong OTP)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/password/reset HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "newPassword": "newPassword123",
  "otp": "9999",
  "userRole": "customer"
}


### 


### POST /api/auth/password/reset (Invalid - expired OTP)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/password/reset HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "newPassword": "newPassword123",
  "otp": "1234",
  "userRole": "customer"
}


### 


### POST /api/auth/password/reset (Invalid - invalid OTP format)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/password/reset HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "newPassword": "newPassword123",
  "otp": "abc",
  "userRole": "customer"
}


### 


### 


### GOOGLE OAUTH


### 


### GET /api/auth/google


### Google OAuth redirect


### Note: This will redirect to Google's OAuth page

GET {{baseUrl}}/api/auth/google HTTP/1.1
Content-Type: {{contentType}}


### 


### GET /api/auth/google/callback


### Google OAuth callback


### Note: This is handled by Google OAuth flow


### Usually accessed via browser redirect, not directly

GET {{baseUrl}}/api/auth/google/callback HTTP/1.1
Content-Type: {{contentType}}


### 


### 


### ADMIN/PARTNER RESOURCES


### 


### POST /api/auth/admin/sessions


### Admin login

POST {{baseUrl}}/api/auth/admin/sessions HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "admin@example.com",
  "password": "adminPassword123",
  "userRole": "admin"
}


### 


### POST /api/auth/admin/sessions


### Partner login

POST {{baseUrl}}/api/auth/admin/sessions HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "partner@example.com",
  "password": "partnerPassword123",
  "userRole": "partner"
}


### 


### POST /api/auth/admin/sessions (Invalid - wrong credentials)


### Should return 401 Unauthorized

POST {{baseUrl}}/api/auth/admin/sessions HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "admin@example.com",
  "password": "wrongpassword",
  "userRole": "admin"
}


### 


### POST /api/auth/admin/users


### Admin registration

POST {{baseUrl}}/api/auth/admin/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "newadmin@example.com",
  "firstName": "John",
  "lastName": "Doe",
  "password": "adminPassword123",
  "phoneNumber": "+1234567890",
  "userRole": "admin"
}


### 


### POST /api/auth/admin/users


### Partner registration

POST {{baseUrl}}/api/auth/admin/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "newpartner@example.com",
  "firstName": "Jane",
  "lastName": "Smith",
  "password": "partnerPassword123",
  "phoneNumber": "+1987654321",
  "userRole": "partner"
}


### 


### POST /api/auth/admin/users (Invalid - missing required fields)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/admin/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "newadmin2@example.com",
  "password": "adminPassword123",
  "userRole": "admin"
}


### 


### POST /api/auth/admin/users (Invalid - invalid phone format)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/admin/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "newadmin3@example.com",
  "firstName": "John",
  "lastName": "Doe",
  "password": "adminPassword123",
  "phoneNumber": "123",
  "userRole": "admin"
}


### 


### POST /api/auth/admin/users (Invalid - user already exists)


### Should return 409 Conflict

POST {{baseUrl}}/api/auth/admin/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "admin@example.com",
  "firstName": "John",
  "lastName": "Doe",
  "password": "adminPassword123",
  "phoneNumber": "+1234567890",
  "userRole": "admin"
}


### 


### 


### OTP RESOURCE (SMS)


### 


### POST /api/auth/otp/sms


### Send SMS OTP - Customer

POST {{baseUrl}}/api/auth/otp/sms HTTP/1.1
Content-Type: {{contentType}}

{
  "phoneNumber": "+1234567890",
  "userRole": "customer"
}


### 


### POST /api/auth/otp/sms


### Send SMS OTP - Partner

POST {{baseUrl}}/api/auth/otp/sms HTTP/1.1
Content-Type: {{contentType}}

{
  "phoneNumber": "+1987654321",
  "userRole": "partner"
}


### 


### POST /api/auth/otp/sms (Invalid - invalid phone format)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/otp/sms HTTP/1.1
Content-Type: {{contentType}}

{
  "phoneNumber": "123",
  "userRole": "customer"
}


### 


### POST /api/auth/otp/sms (Rate limit test)


### Send OTP multiple times to test rate limiting


### Should return 429 Too Many Requests after 3 attempts

POST {{baseUrl}}/api/auth/otp/sms HTTP/1.1
Content-Type: {{contentType}}

{
  "phoneNumber": "+1234567890",
  "userRole": "customer"
}


### 


### POST /api/auth/otp/verify


### Verify SMS OTP


### Note: Replace {{otp}} with the OTP received via SMS

POST {{baseUrl}}/api/auth/otp/verify HTTP/1.1
Content-Type: {{contentType}}

{
  "otp": "1234",
  "phoneNumber": "+1234567890"
}


### 


### POST /api/auth/otp/verify (Invalid - wrong OTP)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/otp/verify HTTP/1.1
Content-Type: {{contentType}}

{
  "otp": "9999",
  "phoneNumber": "+1234567890"
}


### 


### POST /api/auth/otp/verify (Invalid - invalid OTP format)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/otp/verify HTTP/1.1
Content-Type: {{contentType}}

{
  "otp": "abc",
  "phoneNumber": "+1234567890"
}


### 


### POST /api/auth/otp/verify (Invalid - expired OTP)


### Should return 400 Bad Request

POST {{baseUrl}}/api/auth/otp/verify HTTP/1.1
Content-Type: {{contentType}}

{
  "otp": "1234",
  "phoneNumber": "+1234567890"
}


### 


### 


### COMPLETE AUTHENTICATION FLOW EXAMPLES


### 


### Example 1: Customer Registration and Login Flow


### Step 1: Check if email exists

POST {{baseUrl}}/api/auth/email/check HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "newcustomer@example.com",
  "userRole": "customer"
}


### 


### Step 2: Register new customer

POST {{baseUrl}}/api/auth/users HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "newcustomer@example.com",
  "password": "password123",
  "userRole": "customer"
}


### 


### Step 3: Login

POST {{baseUrl}}/api/auth/sessions HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "newcustomer@example.com",
  "password": "password123",
  "userRole": "customer"
}


### 


### Step 4: Check session

GET {{baseUrl}}/api/auth/session HTTP/1.1
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}


### 


### Step 5: Logout

DELETE {{baseUrl}}/api/auth/sessions HTTP/1.1
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}


### 


### Example 2: Password Reset Flow


### Step 1: Request password reset OTP

POST {{baseUrl}}/api/auth/password/forgot HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "userRole": "customer"
}


### 


### Step 2: Reset password with OTP (received via email)

POST {{baseUrl}}/api/auth/password/reset HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "newPassword": "newSecurePassword123",
  "otp": "1234",
  "userRole": "customer"
}


### 


### Step 3: Login with new password

POST {{baseUrl}}/api/auth/sessions HTTP/1.1
Content-Type: {{contentType}}

{
  "email": "{{testEmail}}",
  "password": "newSecurePassword123",
  "userRole": "customer"
}


### 


### 


### RESPONSE FORMAT DOCUMENTATION


### 


### Expected Success Response Format:


### {


### "data": { ... }


### }


### 


### Expected Error Response Format:


### {


### "error": {


### "code": "ERROR_CODE",


### "message": "Human readable message",


### "fields": { ... } // Optional, for validation errors


### }


### }


### 


### Status Codes:


### - 200: Success (GET, PATCH)


### - 201: Created (POST - create resource)


### - 204: No Content (DELETE)


### - 400: Bad Request (validation errors)


### - 401: Unauthorized (invalid credentials)


### - 404: Not Found (resource doesn't exist)


### - 409: Conflict (resource already exists)


### - 429: Too Many Requests (rate limiting)


### - 500: Internal Server Error
